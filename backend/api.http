### GrihaHomes API Tests
### Install "REST Client" extension in VS Code
### Click "Send Request" above each request to test

@baseUrl = http://localhost:3000/api
@accessToken = YOUR_ACCESS_TOKEN_HERE
@refreshToken = YOUR_REFRESH_TOKEN_HERE

### ==================
### AUTH
### ==================

### Login with phone + password
### - If user exists: requires password, returns tokens
### - If user NOT exists: returns { requiresOtp: true, isNewUser: true }
POST {{baseUrl}}/auth/login
Content-Type: application/json

{
  "phone": "+916900000000",
  "password": "Test@1234"
}

### Login with OTP (for existing users who forgot password)
POST {{baseUrl}}/auth/login-otp
Content-Type: application/json

{
  "phone": "+916900000000",
  "idToken": "FIREBASE_ID_TOKEN_FROM_FRONTEND"
}

### Register (for new users - after Firebase OTP verification)
POST {{baseUrl}}/auth/register
Content-Type: application/json

{
  "phone": "+919876543210",
  "idToken": "FIREBASE_ID_TOKEN_FROM_FRONTEND",
  "password": "Test@1234",
  "name": "New User",
  "email": "newuser@example.com"
}

### Reset Password
POST {{baseUrl}}/auth/reset-password
Content-Type: application/json

{
  "phone": "+916900000000",
  "idToken": "FIREBASE_ID_TOKEN_FROM_FRONTEND",
  "newPassword": "NewPass@1234"
}

### Refresh Token
POST {{baseUrl}}/auth/refresh
Content-Type: application/json

{
  "refreshToken": "{{refreshToken}}"
}

### Get Current User
GET {{baseUrl}}/auth/me
Authorization: Bearer {{accessToken}}

### ==================
### USERS
### ==================

### Get My Profile
GET {{baseUrl}}/users/me
Authorization: Bearer {{accessToken}}

### Update My Profile
PATCH {{baseUrl}}/users/me
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "name": "Updated Name",
  "email": "updated@example.com"
}

### List All Users (Admin only)
GET {{baseUrl}}/users?page=1&limit=20
Authorization: Bearer {{accessToken}}

### Get User by ID (Admin only)
GET {{baseUrl}}/users/USER_ID_HERE
Authorization: Bearer {{accessToken}}

### Update User (Admin only)
PATCH {{baseUrl}}/users/USER_ID_HERE
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "role": "owner",
  "status": "active"
}

### Delete User (Admin only)
DELETE {{baseUrl}}/users/USER_ID_HERE
Authorization: Bearer {{accessToken}}

### ==================
### PROPERTIES
### ==================

### List Properties (Public)
GET {{baseUrl}}/properties?page=1&limit=10

### Search by Location (Public)
GET {{baseUrl}}/properties?latitude=19.076&longitude=72.877&radiusKm=10

### Search with Filters (Public)
GET {{baseUrl}}/properties?propertyType=flat&propertyFor=rent&minPrice=10000&maxPrice=50000&city=Mumbai&furnishing=furnished

### Get Property by ID (Public)
GET {{baseUrl}}/properties/PROPERTY_ID_HERE

### Create Property (Owner/Admin)
POST {{baseUrl}}/properties
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "propertyType": "flat",
  "propertyFor": "rent",
  "title": "2BHK Flat in Andheri",
  "description": "Spacious 2BHK flat with great view",
  "rooms": 2,
  "bathrooms": 2,
  "sizeSqft": 1000,
  "floor": 5,
  "price": 35000,
  "deposit": 100000,
  "maintenance": 3000,
  "furnishing": "semi_furnished",
  "parking": "covered",
  "amenities": ["gym", "swimming_pool", "security"],
  "address": "123, ABC Complex, Andheri West",
  "city": "Mumbai",
  "state": "Maharashtra",
  "pincode": "400053",
  "latitude": 19.1364,
  "longitude": 72.8296,
  "availableFrom": "2026-02-01"
}

### Update Property (Owner)
PATCH {{baseUrl}}/properties/PROPERTY_ID_HERE
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "price": 32000,
  "description": "Updated description"
}

### Update Property Status (Owner/Admin)
PATCH {{baseUrl}}/properties/PROPERTY_ID_HERE/status
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "status": "rented"
}

### Delete Property (Owner/Admin)
DELETE {{baseUrl}}/properties/PROPERTY_ID_HERE
Authorization: Bearer {{accessToken}}

### Get My Properties (Owner)
GET {{baseUrl}}/properties/owner/me?page=1&limit=10
Authorization: Bearer {{accessToken}}

### ==================
### MEDIA
### ==================

### Get Upload Signature (Owner)
GET {{baseUrl}}/properties/PROPERTY_ID_HERE/media/signature
Authorization: Bearer {{accessToken}}

### Add Media Record (after Cloudinary upload)
POST {{baseUrl}}/properties/PROPERTY_ID_HERE/media
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "publicId": "grihahomes/properties/PROPERTY_ID/UUID_FROM_SIGNATURE",
  "type": "image",
  "position": 0
}

### Reorder Media
PATCH {{baseUrl}}/properties/PROPERTY_ID_HERE/media/reorder
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "mediaIds": ["MEDIA_ID_1", "MEDIA_ID_2", "MEDIA_ID_3"]
}

### Delete Media
DELETE {{baseUrl}}/media/MEDIA_ID_HERE
Authorization: Bearer {{accessToken}}

### ==================
### INQUIRIES
### ==================

### Create Inquiry
POST {{baseUrl}}/inquiries
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "propertyId": "PROPERTY_ID_HERE",
  "message": "Hi, I am interested in this property. Is it still available?"
}

### Get My Inquiries
GET {{baseUrl}}/inquiries/me?page=1&limit=10
Authorization: Bearer {{accessToken}}

### Get All Inquiries (Admin only)
GET {{baseUrl}}/inquiries?page=1&limit=20&status=pending
Authorization: Bearer {{accessToken}}

### Get Inquiry by ID (Admin only)
GET {{baseUrl}}/inquiries/INQUIRY_ID_HERE
Authorization: Bearer {{accessToken}}

### Update Inquiry Status (Admin only)
PATCH {{baseUrl}}/inquiries/INQUIRY_ID_HERE
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "status": "contacted",
  "adminNotes": "Called the user, they will visit tomorrow"
}
